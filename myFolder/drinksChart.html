<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Drinks on a Date: A Redesigned Visualization</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc;
            color: #1e293b;
        }
        
        .chart-container {
            width: 100%;
            max-width: 900px;
            margin: 2rem auto;
            padding: 2rem;
            background-color: white;
            border-radius: 1rem;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
        }
        
        .axis text {
            font-size: 12px;
            fill: #64748b;
        }
        .axis path, .axis .domain {
            stroke: none;
        }
        .axis .tick line {
            stroke: none; /* Hide grid lines */
        }
        .bar-label {
            font-size: 14px;
            font-weight: 700; /* Bolding the label */
            fill: #475569;
        }
        .drink-label {
            font-size: 16px;
            font-weight: 500;
            fill: #334155;
        }
        .drink-icon {
            font-size: 40px;
            color: #64748b;
        }
        .group-label {
            font-size: 1rem;
            font-weight: 700;
            fill: #334155;
            text-anchor: middle;
        }
    </style>
</head>
<body class="p-4 md:p-8">

    <div class="chart-container">
        <header class="mb-8 text-center">
            <div class="flex justify-center gap-2 mb-4">
                <img src="https://i.ibb.co/vvgt2GYJ/Gemini-Generated-Image-g0oi6og0oi6og0oi.png" alt="Dating drinks icon" class="w-32 h-32 object-contain">
                <img src="https://i.ibb.co/vvgt2GYJ/Gemini-Generated-Image-g0oi6og0oi6og0oi.png" alt="Dating drinks icon" class="w-32 h-32 object-contain">
                <img src="https://i.ibb.co/vvgt2GYJ/Gemini-Generated-Image-g0oi6og0oi6og0oi.png" alt="Dating drinks icon" class="w-32 h-32 object-contain">
                <img src="https://i.ibb.co/vvgt2GYJ/Gemini-Generated-Image-g0oi6og0oi6og0oi.png" alt="Dating drinks icon" class="w-32 h-32 object-contain">
                <img src="https://i.ibb.co/vvgt2GYJ/Gemini-Generated-Image-g0oi6og0oi6og0oi.png" alt="Dating drinks icon" class="w-32 h-32 object-contain">
                <img src="https://i.ibb.co/vvgt2GYJ/Gemini-Generated-Image-g0oi6og0oi6og0oi.png" alt="Dating drinks icon" class="w-32 h-32 object-contain">
            </div>
            <div>
                <h1 class="text-3xl font-bold text-slate-800">What Are <span style="color: #e8cc62;">Men</span> and <span style="color: #d15955;">Women</span> Drinking on Dates?</h1>
                <p class="text-slate-500 mt-2">
                    A side-by-side comparison of drink preferences, based on data from a Zoosk survey.
                </p>
            </div>
        </header>

        <!-- Combined Chart -->
        <div id="chart-combined"></div>

        <footer class="text-center mt-12 pt-6 border-t border-slate-200">
            <p class="text-xs text-slate-500">
                <strong>Data Source:</strong> The dating app Zoosk surveyed 8,793 of its members and analyzed 133,175 dating messages.
            </p>
        </footer>
    </div>

    <script>
        const drinkData = [
            { drink: 'Beer', men: 62, women: 32, type: 'alcoholic', icon: `<span class="material-symbols-outlined drink-icon">sports_bar</span>` },
            { drink: 'Wine', men: 41, women: 62, type: 'alcoholic', icon: `<span class="material-symbols-outlined drink-icon">wine_bar</span>` },
            { drink: 'Margarita', men: 23, women: 29, type: 'alcoholic', icon: `<span class="material-symbols-outlined drink-icon">liquor</span>` },
            { drink: 'Martini', men: 10, women: 11, type: 'alcoholic', icon: `<span class="material-symbols-outlined drink-icon">nightlife</span>`},
            { drink: 'Coffee', men: 26, women: 26, type: 'non-alcoholic', icon: `<span class="material-symbols-outlined drink-icon">coffee</span>` },
            { drink: 'Tea', men: 21, women: 25, type: 'non-alcoholic', icon: `<span class="material-symbols-outlined drink-icon">emoji_food_beverage</span>` },
            { drink: 'Soda', men: 20, women: 21, type: 'non-alcoholic', icon: `<span class="material-symbols-outlined drink-icon">local_drink</span>` },
        ];

        const createVerticalBarChart = (data, svgId) => {
            document.getElementById(svgId).innerHTML = '';
            const container = document.getElementById(svgId);
            const containerWidth = container.clientWidth;
            const subgroups = ['men', 'women'];
            const color = d3.scaleOrdinal().domain(subgroups).range(['#e8cc62', '#d15955']);
            
            // VERTICAL CHART LOGIC
            const margin = { top: 40, right: 20, bottom: 100, left: 40 };
            const height = 400;
            const width = containerWidth - margin.left - margin.right;
            const svg = d3.select(`#${svgId}`).append("svg")
                .attr("width", containerWidth).attr("height", height + margin.top + margin.bottom)
                .append("g").attr("transform", `translate(${margin.left},${margin.top})`);
            
            const drinks = data.map(d => d.drink);
            const xScale = d3.scaleBand().domain(drinks).range([0, width]).padding(0.1);
            const xSubgroup = d3.scaleBand().domain(subgroups).range([0, xScale.bandwidth()]).padding(0.05);
            const yScale = d3.scaleLinear().domain([0, 100]).range([height, 0]); // Scale is now 0-100

            const xAxis = svg.append("g").attr("class", "axis").attr("transform", `translate(0, ${height})`).call(d3.axisBottom(xScale).tickSize(0));
            xAxis.selectAll("text").remove();
            xAxis.selectAll(".tick").append("foreignObject").attr("width", 80).attr("height", 80).attr("x", -40).attr("y", 10)
                .html(d => `<div class="flex flex-col items-center text-center gap-1">${data.find(item => item.drink === d).icon}<span class="drink-label text-xs">${d}</span></div>`);
            
            // Group Labels
            const firstNonAlcIndex = data.findIndex(d => d.type === 'non-alcoholic');
            const groupDividerX = xScale(data[firstNonAlcIndex].drink) - xScale.paddingInner()*xScale.step()/2;

            svg.append("line").attr("x1", groupDividerX).attr("x2", groupDividerX).attr("y1", -25).attr("y2", height).attr("stroke", "#94a3b8").attr("stroke-width", "1").attr("stroke-dasharray", "4");
            svg.append("text").attr("class", "group-label").attr("x", groupDividerX / 2).attr("y", -10).text("Alcoholic");
            svg.append("text").attr("class", "group-label").attr("x", (groupDividerX + width) / 2).attr("y", -10).text("Non-Alcoholic");

            const barGroups = svg.selectAll(".bargroup").data(data).join("g").attr("class", "bargroup").attr("transform", d => `translate(${xScale(d.drink)}, 0)`);

            // Draw background rects (the 100% semi-transparent part)
            barGroups.selectAll(".bar-bg")
                .data(d => subgroups.map(key => ({ key: key, value: d[key] })))
                .join("rect")
                .attr("class", "bar-bg")
                .attr("x", d => xSubgroup(d.key))
                .attr("y", 0)
                .attr("width", xSubgroup.bandwidth())
                .attr("height", height)
                .attr("fill", d => color(d.key))
                .attr("opacity", 0.3);

            // Draw foreground rects (the actual value)
            barGroups.selectAll(".bar-fg")
                .data(d => subgroups.map(key => ({ key: key, value: d[key] })))
                .join("rect")
                .attr("class", "bar-fg")
                .attr("x", d => xSubgroup(d.key))
                .attr("y", d => yScale(d.value))
                .attr("width", xSubgroup.bandwidth())
                .attr("height", d => height - yScale(d.value))
                .attr("fill", d => color(d.key));

            // Draw labels
            barGroups.selectAll(".bar-label")
                .data(d => subgroups.map(key => ({ key: key, value: d[key] })))
                .join("text")
                .attr("class", "bar-label")
                .attr("x", d => xSubgroup(d.key) + xSubgroup.bandwidth() / 2)
                .attr("y", d => yScale(d.value) - 5)
                .attr("text-anchor", "middle")
                .text(d => d.value + "%");
        };

        const drawChart = () => {
            const sortedData = [
                ...drinkData.filter(d => d.type === 'alcoholic'),
                ...drinkData.filter(d => d.type === 'non-alcoholic')
            ];
            createVerticalBarChart(sortedData, 'chart-combined');
        }
        
        drawChart();
        window.addEventListener('resize', drawChart);
    </script>

</body>
</html>

